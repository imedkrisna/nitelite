plot(test, col="red", main="Scatterplot of Test Dataset")
##Decision Tree with Train-Test Split
tree_claim = tree(as.factor(claim)~., train)
summary(tree_claim)
plot(tree_claim)
##Decision Tree with Train-Test Split
tree_claim = tree(as.factor(claim)~., train)
summary(tree_claim)
plot(tree_claim)
##Removing Outliers
summary(insurance$claim)
IQR_claim = 1.00000-0.00000
Upfen_claim = 1.00000+1.5*IQR_claim
Upfen_claim
summary(insurance$agecar)
IQR_agecar = 0.007639-0.001389
Upfen_agecar = 0.007639+1.5*IQR_agecar
Upfen_agecar
summary(insurance$agepolicyholder)
IQR_agepolicyholder = 0.548077-0.355769
Upfen_agepolicyholder = 0.548077+1.5*IQR_agepolicyholder
Upfen_agepolicyholder
summary(insurance$density)
IQR_density = 27003 - 6112
Upfen_density = 27003+1.5*IQR_density
Upfen_density
summary(insurance$make)
IQR_make = 3000-1000
Upfen_make = 3000+1.5*IQR_make
Upfen_make
summary(insurance$airbags)
IQR_airbags = 6000-2000
Upfen_airbags = 6000+1.5*IQR_airbags
Upfen_airbags
summary(insurance$displacement)
IQR_displacement = 1493-998
Upfen_displacement = 1493+1.5*IQR_displacement
Upfen_displacement
summary(insurance$cylinder)
IQR_cylinder = 4000-3000
Upfen_cylinder = 4000+1.5*IQR_cylinder
Upfen_cylinder
summary(insurance$gearbox)
IQR_gearbox = 5000-5000
Upfen_gearbox = 5000+1.5*IQR_gearbox
Upfen_gearbox
summary(insurance$length)
IQR_length = 3995-3655
Upfen_length = 3995+1.5*IQR_length
Upfen_length
summary(insurance$width)
IQR_width = 1755-1515
Upfen_width = 1755+1.5*IQR_width
Upfen_width
summary(insurance$height)
IQR_height = 1635- 1490
Upfen_height = 1635+1.5*IQR_height
Upfen_height
summary(insurance)
insurance_clean1 = subset(insurance, claim <= 0 & agecar <= 0.017014
& agepolicyholder <= 0.836539 & airbags <= 12
& cylinder <= 5.5 & density <= 58339.5 & displacement <= 2235.5 & gearbox <= 5 & make <= 6 & height <= 1852.5 & length <= 4505 & width <= 2115)
boxplot(insurance_clean1, main="Boxplot of Data after Removing Outliers")
### Scaling Data
insurance_clean2 <- scale(insurance_clean1)
boxplot(insurance_clean2, main="Boxplot of Data after Scaling")
insurance_clean2 <- data.frame(insurance_clean2)
#Optimum Number of Cluster
##Elbow method
fviz_nbclust(insurance_clean2, kmeans, method = "wss") +
geom_vline(xintercept = 3, linetype = 2)+
labs(subtitle = "Elbow method")
#Optimum Number of Cluster
##Elbow method
fviz_nbclust(insurance_clean1, kmeans, method = "wss") +
geom_vline(xintercept = 3, linetype = 2)+
labs(subtitle = "Elbow method")
# Merging The Cluster Analysis
##Merge Dataset with Cluster Analysis
res <- cbind(insurance_clean1, km_out$cluster)
insurance_clean1 <- data.frame(insurance_clean1)
#We will train the dataset
##split data into a training set and a test set
set.seed(123)
ntrain = floor(nrow(insurance_clean1)*0.7)
train = insurance_clean1 %>%
sample_n(ntrain)
test = insurance_clean1 %>%
setdiff(train)
##Decision Tree with Train-Test Split
tree_claim = tree(as.factor(claim)~., train)
summary(tree_claim)
plot(tree_claim)
##Removing Outliers
summary(insurance$agecar)
IQR_agecar = 0.007639-0.001389
Upfen_agecar = 0.007639+1.5*IQR_agecar
Upfen_agecar
summary(insurance$agepolicyholder)
IQR_agepolicyholder = 0.548077-0.355769
Upfen_agepolicyholder = 0.548077+1.5*IQR_agepolicyholder
Upfen_agepolicyholder
summary(insurance$density)
IQR_density = 27003 - 6112
Upfen_density = 27003+1.5*IQR_density
Upfen_density
summary(insurance$make)
IQR_make = 3000-1000
Upfen_make = 3000+1.5*IQR_make
Upfen_make
summary(insurance$airbags)
IQR_airbags = 6000-2000
Upfen_airbags = 6000+1.5*IQR_airbags
Upfen_airbags
summary(insurance$displacement)
IQR_displacement = 1493-998
Upfen_displacement = 1493+1.5*IQR_displacement
Upfen_displacement
summary(insurance$cylinder)
IQR_cylinder = 4000-3000
Upfen_cylinder = 4000+1.5*IQR_cylinder
Upfen_cylinder
summary(insurance$gearbox)
IQR_gearbox = 5000-5000
Upfen_gearbox = 5000+1.5*IQR_gearbox
Upfen_gearbox
summary(insurance$length)
IQR_length = 3995-3655
Upfen_length = 3995+1.5*IQR_length
Upfen_length
summary(insurance$width)
IQR_width = 1755-1515
Upfen_width = 1755+1.5*IQR_width
Upfen_width
summary(insurance$height)
IQR_height = 1635- 1490
Upfen_height = 1635+1.5*IQR_height
Upfen_height
summary(insurance)
insurance_clean1 = subset(insurance, claim <= 0 & agecar <= 0.017014
& agepolicyholder <= 0.836539 & airbags <= 12
& cylinder <= 5.5 & density <= 58339.5 & displacement <= 2235.5 & gearbox <= 5 & make <= 6 & height <= 1852.5 & length <= 4505 & width <= 2115)
boxplot(insurance_clean1, main="Boxplot of Data after Removing Outliers")
### Scaling Data
insurance_clean2 <- scale(insurance_clean1)
boxplot(insurance_clean2, main="Boxplot of Data after Scaling")
knitr::opts_chunk$set(echo = TRUE)
##Decision Tree with Train-Test Split
tree_claim = tree(as.factor(claim)~., train)
knitr::opts_chunk$set(echo = TRUE)
# Library
library(factoextra)
library(cluster)
library(ggplot2)
library(dplyr)
library(broom)
library(ggdendro)
library(readxl)
library(fmsb)
library(NbClust)
library(RColorBrewer)
library(gridExtra)
library(tree)
library(ISLR)
library(caTools)
library(randomForest)
library(stats)
library(ggfortify)
library(caret)
library(readxl)
#Import Data
library(readxl)
insurance <- read_excel("Downloads/insurance.xlsx")
knitr::opts_chunk$set(echo = TRUE)
# Library
library(factoextra)
library(cluster)
library(ggplot2)
library(dplyr)
library(broom)
library(ggdendro)
library(readxl)
library(fmsb)
library(NbClust)
library(RColorBrewer)
library(gridExtra)
library(tree)
library(ISLR)
library(caTools)
library(randomForest)
library(stats)
library(ggfortify)
library(caret)
library(readxl)
#Import Data
library(readxl)
insurance <- read_excel("Downloads/insurance.xlsx")
#Import Data
library(readxl)
insurance <- read_excel("Downloads/insurance.xlsx")
#Import Data
library(readxl)
insurance <- read_excel("Downloads/insurance.xlsx")
#Import Data
library(readxl)
insurance <- read_excel("Downloads/insurance1.xlsx")
#Import Data
library(readxl)
insurance1 <- read_excel("Downloads/final project pds/insurance1.xlsx")
knitr::opts_chunk$set(echo = TRUE)
# Library
library(factoextra)
library(cluster)
library(ggplot2)
library(dplyr)
library(broom)
library(ggdendro)
library(readxl)
library(fmsb)
library(NbClust)
library(RColorBrewer)
library(gridExtra)
library(tree)
library(ISLR)
library(caTools)
library(randomForest)
library(stats)
library(ggfortify)
library(caret)
library(readxl)
#Import Data
library(readxl)
insurance1 <- read_excel("Downloads/final project pds/insurance1.xlsx")
#Import Data
library(readxl)
insurance1 <- read_excel("Users/meizahra/Downloads/insurance1.xlsx")
knitr::opts_chunk$set(echo = TRUE)
# Library
library(factoextra)
library(cluster)
library(ggplot2)
library(dplyr)
library(broom)
library(ggdendro)
library(readxl)
library(fmsb)
library(NbClust)
library(RColorBrewer)
library(gridExtra)
library(tree)
library(ISLR)
library(caTools)
library(randomForest)
library(stats)
library(ggfortify)
library(caret)
library(readxl)
#Import Data
library(readxl)
insurance1 <- read_excel("/Users/meizahra/Downloads/Final Project PDS 2022/insurance1.xlsx")
knitr::opts_chunk$set(echo = TRUE)
# Library
library(factoextra)
library(cluster)
library(ggplot2)
library(dplyr)
library(broom)
library(ggdendro)
library(readxl)
library(fmsb)
library(NbClust)
library(RColorBrewer)
library(gridExtra)
library(tree)
library(ISLR)
library(caTools)
library(randomForest)
library(stats)
library(ggfortify)
library(caret)
library(readxl)
#Import Data
library(readxl)
insurance1 <- read_excel("Users/meizahra/Downloads/Final Project PDS 2022/insurance1.xlsx")
knitr::opts_chunk$set(echo = TRUE)
# Library
library(factoextra)
library(cluster)
library(ggplot2)
library(dplyr)
library(broom)
library(ggdendro)
library(readxl)
library(fmsb)
library(NbClust)
library(RColorBrewer)
library(gridExtra)
library(tree)
library(ISLR)
library(caTools)
library(randomForest)
library(stats)
library(ggfortify)
library(caret)
library(readxl)
#Import Data
library(readxl)
insurance1 <- read_excel("Downloads/Final Project PDS LALA/insurance1.xlsx")
View(insurance1)
head(insurance)
tail(insurance)
##Scatterplot
plot(insurance, col="blue", main="Scatterplot Correlation of Dataset")
##Boxplot
boxplot(insurance, main="Boxplot of Data before removing outliers and scaling")
##Removing Outliers
summary(insurance$agecar)
IQR_agecar = 0.007639-0.001389
Upfen_agecar = 0.007639+1.5*IQR_agecar
Upfen_agecar
summary(insurance$agepolicyholder)
IQR_agepolicyholder = 0.548077-0.355769
Upfen_agepolicyholder = 0.548077+1.5*IQR_agepolicyholder
Upfen_agepolicyholder
summary(insurance$density)
IQR_density = 27003 - 6112
Upfen_density = 27003+1.5*IQR_density
Upfen_density
summary(insurance$make)
IQR_make = 3000-1000
Upfen_make = 3000+1.5*IQR_make
Upfen_make
summary(insurance$airbags)
IQR_airbags = 6000-2000
Upfen_airbags = 6000+1.5*IQR_airbags
Upfen_airbags
summary(insurance$displacement)
IQR_displacement = 1493-998
Upfen_displacement = 1493+1.5*IQR_displacement
Upfen_displacement
summary(insurance$cylinder)
IQR_cylinder = 4000-3000
Upfen_cylinder = 4000+1.5*IQR_cylinder
Upfen_cylinder
summary(insurance$gearbox)
IQR_gearbox = 5000-5000
Upfen_gearbox = 5000+1.5*IQR_gearbox
Upfen_gearbox
summary(insurance$length)
IQR_length = 3995-3655
Upfen_length = 3995+1.5*IQR_length
Upfen_length
summary(insurance$width)
IQR_width = 1755-1515
Upfen_width = 1755+1.5*IQR_width
Upfen_width
summary(insurance$height)
IQR_height = 1635- 1490
Upfen_height = 1635+1.5*IQR_height
Upfen_height
summary(insurance)
insurance_clean1 = subset(insurance, agecar <= 0.017014
& agepolicyholder <= 0.836539 & airbags <= 12
& cylinder <= 5.5 & density <= 58339.5 & displacement <= 2235.5 & gearbox <= 5 & make <= 6 & height <= 1852.5 & length <= 4505 & width <= 2115)
boxplot(insurance_clean1, main="Boxplot of Data after Removing Outliers")
### Scaling Data
insurance_clean2 <- scale(insurance_clean1)
boxplot(insurance_clean2, main="Boxplot of Data after Scaling")
##Histogram
par(mfrow=c(2,2))
hist(insurance_clean2[,1], col="darkred", main = "claim")
hist(insurance_clean2[,2], col="pink", main = "agecar")
hist(insurance_clean2[,3], col="cadetblue3", main = "agepolicyholder")
hist(insurance_clean2[,4], col="coral3", main = "airbags")
hist(insurance_clean2[,5], col="darkolivegreen", main = "cylinder")
hist(insurance_clean2[,6], col="cyan4", main = "density")
hist(insurance_clean2[,7], col="cadetblue", main = "displacement")
hist(insurance_clean2[,8], col="cadetblue", main = "gearbox")
hist(insurance_clean2[,9], col="green", main = "make")
```{r}
```{r}
#Classification
insurance_clean1 <- data.frame(insurance_clean1)
#We will train the dataset
##split data into a training set and a test set
set.seed(123)
ntrain = floor(nrow(insurance_clean1)*0.7)
train = insurance_clean1 %>%
sample_n(ntrain)
test = insurance_clean1 %>%
setdiff(train)
##Plot both subset to view the split
plot(train, col="blue", main="Scatterplot of Train Dataset")
plot(test, col="red", main="Scatterplot of Test Dataset")
##Decision Tree with Train-Test Split
tree_claim = tree(as.factor(claim)~., train)
summary(tree_claim)
plot(tree_claim)
text(tree_claim, pretty = 1, cex = 0.5, col = "blue")
plot(train, col="blue", main="Scatterplot of Train Dataset")
plot(test, col="red", main="Scatterplot of Test Dataset")
##Predict with Decision Tree
predict(tree_claim, test, type = 'class')
tree_pred = predict(tree_claim, test, type ='class')
ori = table(tree_pred, test$claim)
ori
#We will train the dataset
##split data into a training set and a test set
set.seed(123)
ntrain = floor(nrow(insurance_clean1)*0.7)
train = insurance_clean1 %>%
sample_n(ntrain)
test = insurance_clean1 %>%
setdiff(train)
##Plot both subset to view the split
plot(train, col="blue", main="Scatterplot of Train Dataset")
plot(test, col="red", main="Scatterplot of Test Dataset")
##Decision Tree with Train-Test Split
tree_claim = tree(as.factor(claim)~., train)
summary(tree_claim)
plot(tree_claim)
text(tree_claim, pretty = 1, cex = 0.5, col = "blue")
plot(train, col="blue", main="Scatterplot of Train Dataset")
plot(test, col="red", main="Scatterplot of Test Dataset")
##Predict with Decision Tree
predict(tree_claim, test, type = 'class')
tree_pred = predict(tree_claim, test, type ='class')
ori = table(tree_pred, test$claim)
ori
insurance_clean2 <- data.frame(insurance_clean2)
#Optimum Number of Cluster
##Elbow method
fviz_nbclust(insurance_clean1, kmeans, method = "wss") +
geom_vline(xintercept = 3, linetype = 2)+
labs(subtitle = "Elbow method")
# K-Means Method
set.seed(123)
km_out = kmeans(insurance, 3)
##Visualize K-Means Output
fviz_cluster(km_out, data = insurance, main="K Means Cluster Plot of Data")
# Merging The Cluster Analysis
##Merge Dataset with Cluster Analysis
res <- cbind(insurance_clean1, km_out$cluster)
##Find the aggregate means of each independent variable in each clusters
new <- aggregate(res[,-ncol(res)], list(res[,ncol(res)]), mean)
# K-Means Method
set.seed(123)
km_out = kmeans(insurance, 3)
# K-Means Method
set.seed(123)
km_out = kmeans(insurance, 3)
print(km_out)
knitr::opts_chunk$set(echo = TRUE)
# Library
library(factoextra)
library(cluster)
library(ggplot2)
library(dplyr)
library(broom)
library(ggdendro)
library(readxl)
library(fmsb)
library(NbClust)
library(RColorBrewer)
library(gridExtra)
library(tree)
library(ISLR)
library(caTools)
library(randomForest)
library(stats)
library(ggfortify)
library(caret)
library(readxl)
#Import Data
library(readxl)
insurance1 <- read_excel("Users/meizahra/Downloads/insurance1.xlsx")
insurance1 <- read_excel("Users/meizahra/Downloads/insurance1.xlsx")
library (rlang)
library(tree)
library(ISLR)
library(dplyr)
library(ggplot2)
library(readxl)
library (tibble)
library(rpart)
library(rpart.plot)
library(caTools)
library(randomForest)
library(ROCR)
remove.packages("knitr", lib = "/Library/Frameworks/R.framework/Versions/4.2/Resources/library")
install.packages("knitr")
knitr::opts_chunk$set(echo = TRUE)
update.packages(ask = FALSE, checkBuilt = TRUE)
.rs.restartR()
install.packages(c("xfun","knitr","rmarkdown"),
repos = "https://cloud.r-project.org")
update.packages(ask = FALSE)
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/meizahra/Documents/nitelite/Lala")
includeHTML("reg/ntl_analysis.html")
install.packages("htmltools")
includeHTML("reg/ntl_analysis.html")
knitr::opts_chunk$set(echo = TRUE)
library(htmltools)
includeHTML("reg/ntl_analysis.html")
install.packages("htmltools")
includeHTML("reg/ntl_analysis.html")
knitr::opts_chunk$set(echo = TRUE)
install.packages("htmltools")
knitr::opts_chunk$set(echo = TRUE)
install.packages("htmltools")
includeHTML("reg/ntl_analysis.html")
